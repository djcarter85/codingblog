<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="theme-color" content="#05324d" />

    <title>Champions League Draw, Revisited | DC Coding</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Rubik:ital,wght@0,400;0,700;1,400;1,700&family=Trirong:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/assets/css/main.css" />
    <link rel="stylesheet" href="/assets/css/code.css" />

    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS Feed for DC Coding"
      href="/Feed/"
    />
  </head>

  <body class="flex min-h-screen flex-col bg-gray-100">
    <nav class="bg-gray-800">
      <div class="container flex flex-row justify-center px-6">
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/"
          >Home</a
        >
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/Archive"
          >Archive</a
        >
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/About"
          >About</a
        >
        
      </div>
    </nav>

    
 <div class="bg-blue-800">
  <div class="container py-8">
    <h1 class="font-title text-5xl font-bold italic text-gray-50">
      Champions League Draw, Revisited
    </h1>
    
    <p class="mt-2 text-lg text-gray-200">10 July 2019</p>
    
  </div>
</div>


<div class="container py-6">
  <p class="mb-6 text-3xl italic text-gray-500">How do you deal with randomness in .NET code?</p>

  <article class="prose"><p>Over the last couple of months, Eric Lippert has written a series of blog posts
explaining how best to deal with randomness in .NET code (<a href="https://ericlippert.com/2019/01/31/fixing-random-part-1/">starting
here</a>).</p>
<p>His main argument is that the standard .NET API for randomness is not very good,
and he goes on to describe how to write code involving randomness in a much
cleaner and more understandable way.</p>
<p>The motivation behind this is great. First off, he's totally right; the standard
.NET API for random number generation is a bit naff. But also, as machine
learning and genetic algorithms become more and more prevalent in the way we use
computers to solve problems, being able to express stochastic algorithms clearly
in code is only going to become more important as time goes on.</p>
<p>A while back I wrote <a href="/2019/03/14/champions-league-draw">an article about simulating the Champions League
quarter-final draw</a>. This obviously involved
a source of randomness, so I thought it would be interesting to revisit my code
and see if I can improve it by using some of the ideas from Eric Lippert’s
posts.</p>
<p>I’ve put the code for this article on <a href="https://github.com/djcarter85/ChampionsLeagueDraw/tree/distributions">a separate branch in the original
repository</a>.</p>
<h2>A new interface</h2>
<p>Lippert's fundamental abstraction is that of a <strong>distribution</strong>: a source of
random values of a given type. This is modelled using a simple interface:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name">T</span> <span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>From this, we can start with simple implementations of the interface and combine
them to make more complicated ones. For example, the <a href="https://github.com/ericlippert/probability/blob/episode03/Probability/StandardContinuousUniform.cs">standard continuous
uniform
distribution</a>,
which returns real values satisfying \(0 \leq x &lt; 1\), or the <a href="https://github.com/ericlippert/probability/blob/episode04/Probability/Singleton.cs">singleton
distribution</a>,
which always returns the same value.</p>
<p>Such abstractions and implementations could be put into a small class library; I
wouldn't be surprised to see one appear on NuGet in the near future.</p>
<p>Lippert also defines an extension method for producing a stream of samples, of
which I have made a modified version to remove the infinite loop:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">DistributionExtensions</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Lippert's extension method</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token generic-method"><span class="token function">Samples</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> distribution<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> distribution<span class="token punctuation">.</span><span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Modified version to avoid infinite loop</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token generic-method"><span class="token function">TakeSamples</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> distribution<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> numberOfSamples<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numberOfSamples<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> distribution<span class="token punctuation">.</span><span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>Recap</h2>
<p>The main class in my previous implementation of the problem was the
<code>FixtureList</code> class, an abbreviated version of which is shown below.</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FixtureList</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Team<span class="token punctuation">></span></span> Teams <span class="token operator">=</span> <span class="token range operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword">private</span> <span class="token function">FixtureList</span><span class="token punctuation">(</span><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Match<span class="token punctuation">></span></span> matches<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token range operator">..</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token range operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">FixtureList</span> <span class="token function">CreateRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> matches <span class="token operator">=</span> Teams
            <span class="token punctuation">.</span><span class="token function">Shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Batch</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>batch <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Match</span><span class="token punctuation">(</span>batch<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> batch<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FixtureList</span><span class="token punctuation">(</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>The only random part of this is the call to <code>.Shuffle()</code>, a method from the
<a href="https://github.com/morelinq">MoreLINQ library</a>. Everything else is
deterministic.</p>
<p>This is then used in my program's main method as follows:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>FixtureList<span class="token punctuation">></span></span> Distribution <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FixtureListDistribution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>

        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> index <span class="token keyword">in</span> Enumerable<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> totalNumberOfFixtureLists<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> fixtureList <span class="token operator">=</span> FixtureList<span class="token punctuation">.</span><span class="token function">CreateRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Collate results ...</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>Let's make some changes ...</h2>
<p>The first thing to notice is that the <code>CreateRandom()</code> method has exactly the
right signature for an implementation of <code>IDistribution&lt;FixtureList&gt;</code>. So that
was pretty easy to extract:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FixtureListDistribution</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>FixtureList<span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Team<span class="token punctuation">></span></span> Teams <span class="token operator">=</span> <span class="token range operator">..</span><span class="token punctuation">.</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">FixtureList</span> <span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> matches <span class="token operator">=</span> Teams
            <span class="token punctuation">.</span><span class="token function">Shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Batch</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>batch <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Match</span><span class="token punctuation">(</span>batch<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> batch<span class="token punctuation">.</span><span class="token function">ElementAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FixtureList</span><span class="token punctuation">(</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>The call site then changes to:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>FixtureList<span class="token punctuation">></span></span> Distribution <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FixtureListDistribution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>

        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> fixtureList <span class="token keyword">in</span> Distribution<span class="token punctuation">.</span><span class="token function">TakeSamples</span><span class="token punctuation">(</span>totalNumberOfFixtureLists<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Collate results ...</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>But we can go further: rather than using <code>Shuffle()</code> from MoreLINQ, where we
have no control over the implementation nor the source of randomness, we can
implement our own <code>ShuffleDistribution</code> using the <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle">Fisher-Yates
method</a>.</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShuffleDistribution<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDistribution<span class="token punctuation">&lt;</span>IReadOnlyList<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span><span class="token punctuation">></span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> source<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">ShuffleDistribution</span><span class="token punctuation">(</span><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> source<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>source <span class="token operator">=</span> source<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">IReadOnlyList<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> array <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>source<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">var</span></span> totalNumberOfItems <span class="token operator">=</span> array<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> index1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index1 <span class="token operator">&lt;</span> totalNumberOfItems<span class="token punctuation">;</span> index1<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> randomIndex2 <span class="token operator">=</span> StandardDiscreteUniform<span class="token punctuation">.</span><span class="token function">Distribution</span><span class="token punctuation">(</span>index1<span class="token punctuation">,</span> totalNumberOfItems <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">SwapItemsAtIndexes</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> index1<span class="token punctuation">,</span> randomIndex2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> array<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwapItemsAtIndexes</span><span class="token punctuation">(</span><span class="token class-name">IList<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> array<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> index1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> index2<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> item1 <span class="token operator">=</span> array<span class="token punctuation">[</span>index1<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> item2 <span class="token operator">=</span> array<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">;</span>

        array<span class="token punctuation">[</span>index1<span class="token punctuation">]</span> <span class="token operator">=</span> item2<span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>index2<span class="token punctuation">]</span> <span class="token operator">=</span> item1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>[Shout out to <a href="http://datagenetics.com/blog/november42014/index.html">this blog post by
DataGenetics</a>, which was
really helpful in improving my understanding of shuffling algorithms.]</p>
<p>The simple distributions that this is based on (e.g. <code>StandardDiscreteUniform</code>)
were taken from Eric Lippert's blog posts, as is his implementation of a source
of randomness with higher precision.</p>
<h2>Reflections</h2>
<p>Having played around with this a little, my overwhelming response is a positive
one! Writing understandable code is all about creating the right abstractions,
and the <code>IDistribution&lt;T&gt;</code> interface is a simple abstraction that makes it easy
to write code that uses randomness in some way.</p>
<p>If you wanted to test code that uses a random value, the <code>IDistribution&lt;T&gt;</code>
interface might be the right interface to inject as a dependency which you could
mock out for unit testing. However, in some cases I could see that you might
need to introduce another interface; for example, if testing code that requires
a random integer up to a maximum value, the following interface might be helpful
for mocking purposes:</p>
<pre class="language-cs"><code class="language-cs"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IIntegerDistribution</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Sample</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> upperBound<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>If you wanted to unit test an implementation of a distribution, I think there
are some tricky obstacles to overcome. The whole point of a distribution is that
the value that comes backfrom it is random. How can you test against a
hard-coded expected outcome?</p>
<p>Perhaps you could take 1000 samples (or some other large number) and check that
the values returned correspond to the expected distribution. In this case, you'd
have to give some sort of tolerance that the distribution must fall within for
the test to pass. How do you choose that tolerance? Too small and the test will
frequently fail; too large and there's a high chance of the test passing even if
the code is wrong. Is it acceptable for the test to simply fail sometimes
because of random chance?</p>
<p>Another way to tackle this problem would be to inject any dependent
distributions into the class under test. The problem with this is that the tests
would be heavily dependent on the implementation. For example, suppose you
wanted to test a distribution which returns heads or tails with equal
probability, and depends on the standard continuous uniform distribution as its
underlying source of randomness. There's nothing canonical about which values
betwen 0 and 1 correspond to which outcome, and so as soon as you write a test,
you're tying yourself into a particular implementation! Your test might fail
even though the distribution is working perfectly fine.</p>
<p>I suspect the best way to implement any distributions is to rely on a base
source of randomness (e.g. <a href="https://ericlippert.com/2019/02/04/fixing-random-part-2/">Lippert's <code>BetterRandom</code>
implementation</a>) and
use well-known algorithms (for example, <a href="https://en.wikipedia.org/wiki/Pseudo-random_number_sampling">see
here</a>) to produce
the random values. You would then forego unit testing entirely, and focus on
unit testing the code which samples from your distributions, which is where your
complicated (and therefore potentially error-prone) business logic is likely to
be.</p>
<p>If you have any insights on this, <a href="/About">get in touch</a>!</p>
</article>
</div>

<div class="container py-6">
  <script
    src="https://utteranc.es/client.js"
    repo="djcarter85/codingblog"
    issue-term="url"
    label="comments"
    theme="github-light"
    crossorigin="anonymous"
    async
  ></script>
</div>


    <footer class="footer mt-auto bg-blue-800 py-4 text-gray-50">
      <div class="container flex flex-col gap-2">
        <div class="flex flex-row justify-center gap-4">
          
          <a
            class="rounded-lg p-2 hover:bg-blue-500"
            href="https://github.com/djcarter85"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x"></i>
          </a>
          
          <a
            class="rounded-lg p-2 hover:bg-blue-500"
            href="/Feed/"
            title="RSS"
          >
            <i class="fa fa-rss fa-2x"></i>
          </a>
          
        </div>
        <div class="text-center">
          &copy; Dan Carter 2024
        </div>
      </div>
    </footer>

    <!-- JS -->
    <script
      defer
      src="https://use.fontawesome.com/releases/v5.6.3/js/all.js"
      integrity="sha384-EIHISlAOj4zgYieurP0SdoiBYfGJKkgWedPHH4jCzpCXLmzVsw1ouK59MuUtP4a1"
      crossorigin="anonymous"
    ></script>

    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>
  </body>
</html>
