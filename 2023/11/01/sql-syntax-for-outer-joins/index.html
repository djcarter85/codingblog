<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="theme-color" content="#05324d" />

    <title>SQL syntax for outer joins | DC Coding</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Rubik:ital,wght@0,400;0,700;1,400;1,700&family=Trirong:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="/assets/css/main.css" />
    <link rel="stylesheet" href="/assets/css/code.css" />

    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS Feed for DC Coding"
      href="/Feed/"
    />
  </head>

  <body class="flex min-h-screen flex-col bg-gray-100">
    <nav class="bg-gray-800">
      <div class="container flex flex-row justify-center px-6">
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/"
          >Home</a
        >
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/Archive"
          >Archive</a
        >
        
        <a
          class="px-4 py-2 text-lg text-gray-100 hover:bg-gray-700 hover:underline"
          href="/About"
          >About</a
        >
        
      </div>
    </nav>

    
 <div class="bg-blue-800">
  <div class="container py-8">
    <h1 class="font-title text-5xl font-bold italic text-gray-50">
      SQL syntax for outer joins
    </h1>
    
    <p class="mt-2 text-lg text-gray-200"> 1 November 2023</p>
    
  </div>
</div>


<div class="container py-6">
  <p class="mb-6 text-3xl italic text-gray-500">How to switch between syntax variants for joins in SQL.</p>

  <article class="prose"><p>I've recently been working on a project to migrate a system based on Oracle to
support SQL Server. Some of the existing SQL used syntax for outer joins which is
not supported on SQL Server, so I had to update it. This article describes how
to migrate SQL which uses the Oracle-specfic syntax to support both platforms.</p>
<h2>Example</h2>
<p>In this article I'll use an example from a Human Resources database, which has
employees (<code>employee</code>) and departments (<code>department</code>). There is a one-to-many
relationship between the two (an employee is in one department and a department
contains many employees) defined by a foreign key from <code>employee.department_id</code>
to <code>department.id</code>.</p>
<h2>Inner joins</h2>
<p>There are two different ways of writing inner joins in SQL.</p>
<p>The older syntax specifies both tables in the <code>FROM</code> clause and filters them in
the <code>WHERE</code> clause:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e<span class="token punctuation">,</span> department d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id</code></pre>
<p>The newer syntax uses the more explicit <code>JOIN</code> and <code>ON</code> keywords:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e
<span class="token keyword">JOIN</span> department d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id</code></pre>
<p>The two are equivalent and will produce the same results (although performance
characteristics might vary depending on the database platform). Using an
explicit <code>JOIN</code> is generally regarded as best practice (e.g. see
<a href="https://stackoverflow.com/a/1599201">https://stackoverflow.com/a/1599201</a>).</p>
<h2>Outer joins</h2>
<p>An outer join is used when the foreign key column on the child table
is nullable; in our example, this corresponds to <code>employee</code> having a nullable
<code>department_id</code> column (an employee might not belong to a department).</p>
<p>Both Oracle and SQL Server have support for outer joins using the <code>OUTER JOIN</code>
keyword. It comes in two flavours: <code>LEFT OUTER JOIN</code> and <code>RIGHT OUTER JOIN</code>.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> department d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id

<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> department d
<span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> employee e
<span class="token keyword">ON</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id</code></pre>
<p>The <code>LEFT</code> or <code>RIGHT</code> denotes which side of the join is <em>required</em>. In our
example, the <code>employee</code> table is required, so when the <code>employee</code> table is
mentioned first we use a left join and when it's mentioned second we use a right
join.</p>
<p>Note that the <code>LEFT</code> or <code>RIGHT</code> is determined by the order in which the tables
are mentioned, not which side of the <code>=</code> sign they appear. It's possible
(although less readable in my opinion) to have the <code>ON</code> clause in a different
order to the table declarations; e.g.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> department d
<span class="token keyword">ON</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id</code></pre>
<p>In this case it's still a <code>LEFT</code> join because <code>employee</code> (the required table)
comes before <code>department</code>, and so <code>employee</code> is the left table.</p>
<p>On SQL Server it's not possible to define an outer join using the <code>WHERE</code>
syntax; your only option is to use an explicit <code>OUTER JOIN</code>. However Oracle has
its own special syntax for outer joins, which looks like this:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e<span class="token punctuation">,</span> department d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span></code></pre>
<p>The <code>(+)</code> symbol denotes which side of the join is <em>optional</em>. In our example,
the <code>department</code> table is optional so the <code>(+)</code> goes next to <code>d.id</code>.</p>
<h2>How to migrate</h2>
<p>Here's how to migrate from the Oracle-specific syntax to use an <code>OUTER JOIN</code>.</p>
<ul>
<li>Using the <code>(+)</code> symbol, determine which of the tables is optional.</li>
<li>This means that the other table is required.</li>
<li>If the first table mentioned is required, use a <code>LEFT OUTER JOIN</code>.</li>
<li>If the second table mentioned is required, use a <code>RIGHT OUTER JOIN</code>.</li>
</ul>
<p>Let's use our example to illustrate this. We start with the Oracle syntax.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e<span class="token punctuation">,</span> department d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span></code></pre>
<p>The placement of the <code>(+)</code> tells us that <code>department</code> is optional. This means
that <code>employee</code> is required. As <code>employee</code> is mentioned first, we need a <code>LEFT OUTER JOIN</code>.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span> employee e
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> department d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id</code></pre>
</article>
</div>

<div class="container py-6">
  <script
    src="https://utteranc.es/client.js"
    repo="djcarter85/codingblog"
    issue-term="url"
    label="comments"
    theme="github-light"
    crossorigin="anonymous"
    async
  ></script>
</div>


    <footer class="footer mt-auto bg-blue-800 py-4 text-gray-50">
      <div class="container flex flex-col gap-2">
        <div class="flex flex-row justify-center gap-4">
          
          <a
            class="rounded-lg p-2 hover:bg-blue-500"
            href="https://github.com/djcarter85"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x"></i>
          </a>
          
          <a
            class="rounded-lg p-2 hover:bg-blue-500"
            href="/Feed/"
            title="RSS"
          >
            <i class="fa fa-rss fa-2x"></i>
          </a>
          
        </div>
        <div class="text-center">
          &copy; Dan Carter 2025
        </div>
      </div>
    </footer>

    <!-- JS -->
    <script
      defer
      src="https://use.fontawesome.com/releases/v5.6.3/js/all.js"
      integrity="sha384-EIHISlAOj4zgYieurP0SdoiBYfGJKkgWedPHH4jCzpCXLmzVsw1ouK59MuUtP4a1"
      crossorigin="anonymous"
    ></script>

    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>
  </body>
</html>
